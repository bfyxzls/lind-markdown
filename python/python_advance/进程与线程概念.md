## 进程
**进程是一个实体，每个进程都有自己的地址空间（CPU分配）。**
实体空间包括三部分：
- 文本区域：存储处理器执行的代码
- 数据区域： 存储变量或进程执行期间使用的动态分配的内存
- 堆栈： 进程执行时调用的指令和本地变量

**进程是一个“执行中的程序”：**
- 程序是指令与数据的有序集合
- 程序本身没有生命，只有CPU赋予程序生命(CPU执行程序)，它才成为一个活动的实体(进程)

概括来说，**进程进程就是一个具有独立功能的程序在某个数据集上的一次运行活动。
进程的特点**：
- 动态性：进程是程序的一次执行过程，动态产生，动态消亡
- 独立性：进程是一个能独立运行的基本单元，是系统分配资源与调度的基本单位
- 并发性：任何进程都可以与其他进程并发执行

## 并发与并行
**并发**：在操作系统中，某个时间段，几个程序在同一个CPU上运行，但在任意一个时间点上，只有一个程序在CPU上运行。

**并行**：当操作系统有多个CPU时，一个CPU处理A线程，另一个CPU处理B线程，两个线程互相不抢占CPU资源，可以同时进行，这种方式称为并行。

**当有多个线程时，只有一个CPU，那么CPU不可能真正同时运行多个线程，CPU的运行时间会被划分成多个时间段，每个时间段分配给各个线程去执行，一个时间段里某个线程运行，其他线程处于挂起状态，这就是并发。并发解决了程序排队等待的问题，如果一个程序发生阻塞，其他程序仍可以正常运行。**

**区别**：

并发只是在宏观上给人感觉有多个程序在同时运行，但在实际的单CPU系统中，每一时刻只有一个程序在运行，微观上这些程序是分时交替执行的。

在多CPU系统上，这些并发执行的程序被分配到不同的CPU上去处理，每个CPU用来处理一个程序，这样多个程序便实现了同时运行。
## 线程
**线程的引入：**<br>
60年代，操作系统中拥有资源并独立运行的是进程，进程是资源的拥有者，进程的创建，撤销，切换花销太大，多CPU的出现，可以满足多个单位同时运行，但是多个进程并行花销太大。80年代出现了轻量级的，能够独立运行的基本单位，线程。

**线程的概念：**<br>
**线程是进程中的一个实体，是被系统独立调用和分派的基本单位**。线程的实体包括程序、数据、TCB，TCB包括：
- 线程状态
- 线程不运行时保存的现场资源
- 一组执行堆栈
- 每个线程的局部变量
- 访问统一进程中的资源

**线程自己不拥有系统资源，只拥有一点运行中必不可少的资源。
同一个进程中的多个线程并发执行，这些线程共享进程所拥有的资源。**
## 进程与线程的区别
- 进程是CPU资源分配的基本单位，线程是独立运行与调度的基本单位（CPU上真正运行的是线程）
- 进程拥有自己的资源空间，一个进程包含若干个线程，线程与CPU资源分配无关，多个线程共享同一进程内的资源
- 线程的调度与切换比进程快很多

## python中的GIL(全局解释器)
CPython环境下，每个进程都拥有一个GIL，单进程下的多线程，某个线程想要执行，必须现获取GIL，才可以进入CPU执行。python虚拟机按照以下方式执行：
1. 设置GIL
2. 切换到一个线程去执行
3. 运行代码，这里有两种机制：
    * 指定数量的字节码指令（100个）
    * 固定时间15ms线程主动让出控制
4. 把线程设置为睡眠状态
5. 解锁GIL
6. 再次重复以上步骤

GIL释放的情况：
1. 执行的字节码行数到达一定阈值
2. 通过时间片划分，到达一定时间阈值
3. 在遇到IO操作时，主动释放


## IO密集型与CPU密集型
**CPU密集型**：CPU密集型的程序需要进行大量的计算，如计算圆周率等，CPU的使用率很高，任务本身不太需要访问IO设备（硬盘）。**这种计算密集型的任务，对代码的运行效率要求很高，python多线程之间切换，频繁GIL的释放与获取，并不能很好的利用cpu的资源，所以Python不太适合做CPU密集型的任务，这类任务最好是C语言完成。如果选用Python的话可以用Python的多进程利用多核资源**。

**IO密集型**： 系统运行的大部分时间，都是CPU在等待IO的读写操作，CPU的使用率并不高，此时使用python多线程，多个任务并发执行，不会像单个线程那样一个任务阻塞导致整个线程阻塞，能够有效提升效率。对于IO密集型的任务，用C语言还是用Python都差不多，因为大部分时间都是IO操作，**这类任务比较适合Python多线程来完成（开发速度快）**。

## 为什么说python多线程没用
CPython解释器本身就不是线程安全的，因此有全局解释器锁（GIL），一次只允许使用一个线程执行Python字节码。因此，一个Python进程中的多个线程不能同时使用多个CPU核心（java中一个进程中的多线程可以利用多核cpu）。

但是Python标准库中的所有阻塞型I/O函数都会释放GIL，允许其他线程运行。time.sleep()函数也会释放GIL。因此，尽管有GIL，Python多线程还是能在I/O密集型应用中发挥作用。
